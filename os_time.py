"""TimeZones:

Africa/Abidjan                    America/Merida                    Asia/Kuching              Europe/Copenhagen
Africa/Accra                      America/Metlakatla                Asia/Macau                Europe/Dublin
Africa/Algiers                    America/Mexico_City               Asia/Magadan              Europe/Gibraltar
Africa/Bissau                     America/Miquelon                  Asia/Makassar             Europe/Helsinki
Africa/Cairo                      America/Moncton                   Asia/Manila               Europe/Istanbul
Africa/Casablanca                 America/Monterrey                 Asia/Nicosia              Europe/Kaliningrad
Africa/Ceuta                      America/Montevideo                Asia/Novokuznetsk         Europe/Kiev
Africa/El_Aaiun                   America/Nassau                    Asia/Novosibirsk          Europe/Kirov
Africa/Johannesburg               America/New_York                  Asia/Omsk                 Europe/Lisbon
Africa/Juba                       America/Nipigon                   Asia/Oral                 Europe/London
Africa/Khartoum                   America/Nome                      Asia/Pontianak            Europe/Luxembourg
Africa/Lagos                      America/Noronha                   Asia/Pyongyang            Europe/Madrid
Africa/Maputo                     America/North_Dakota/Beulah       Asia/Qatar                Europe/Malta
Africa/Monrovia                   America/North_Dakota/Center       Asia/Qostanay             Europe/Minsk
Africa/Nairobi                    America/North_Dakota/New_Salem    Asia/Qyzylorda            Europe/Monaco
Africa/Ndjamena                   America/Nuuk                      Asia/Riyadh               Europe/Moscow
Africa/Sao_Tome                   America/Ojinaga                   Asia/Sakhalin             Europe/Oslo
Africa/Tripoli                    America/Panama                    Asia/Samarkand            Europe/Paris
Africa/Tunis                      America/Pangnirtung               Asia/Seoul                Europe/Prague
Africa/Windhoek                   America/Paramaribo                Asia/Shanghai             Europe/Riga
America/Adak                      America/Phoenix                   Asia/Singapore            Europe/Rome
America/Anchorage                 America/Port-au-Prince            Asia/Srednekolymsk        Europe/Samara
America/Araguaina                 America/Port_of_Spain             Asia/Taipei               Europe/Saratov
America/Argentina/Buenos_Aires    America/Porto_Velho               Asia/Tashkent             Europe/Simferopol
America/Argentina/Catamarca       America/Puerto_Rico               Asia/Tbilisi              Europe/Sofia
America/Argentina/Cordoba         America/Punta_Arenas              Asia/Tehran               Europe/Stockholm
America/Argentina/Jujuy           America/Rainy_River               Asia/Thimphu              Europe/Tallinn
America/Argentina/La_Rioja        America/Rankin_Inlet              Asia/Tokyo                Europe/Tirane
America/Argentina/Mendoza         America/Recife                    Asia/Tomsk                Europe/Ulyanovsk
America/Argentina/Rio_Gallegos    America/Regina                    Asia/Ulaanbaatar          Europe/Uzhgorod
America/Argentina/Salta           America/Resolute                  Asia/Urumqi               Europe/Vienna
America/Argentina/San_Juan        America/Rio_Branco                Asia/Ust-Nera             Europe/Vilnius
America/Argentina/San_Luis        America/Santarem                  Asia/Vladivostok          Europe/Volgograd
America/Argentina/Tucuman         America/Santiago                  Asia/Yakutsk              Europe/Warsaw
America/Argentina/Ushuaia         America/Santo_Domingo             Asia/Yangon               Europe/Zaporozhye
America/Asuncion                  America/Sao_Paulo                 Asia/Yekaterinburg        Europe/Zurich
America/Atikokan                  America/Scoresbysund              Asia/Yerevan              HST
America/Bahia                     America/Sitka                     Atlantic/Azores           Indian/Chagos
America/Bahia_Banderas            America/St_Johns                  Atlantic/Bermuda          Indian/Christmas
America/Barbados                  America/Swift_Current             Atlantic/Canary           Indian/Cocos
America/Belem                     America/Tegucigalpa               Atlantic/Cape_Verde       Indian/Kerguelen
America/Belize                    America/Thule                     Atlantic/Faroe            Indian/Mahe
America/Blanc-Sablon              America/Thunder_Bay               Atlantic/Madeira          Indian/Maldives
America/Boa_Vista                 America/Tijuana                   Atlantic/Reykjavik        Indian/Mauritius
America/Bogota                    America/Toronto                   Atlantic/South_Georgia    Indian/Reunion
America/Boise                     America/Vancouver                 Atlantic/Stanley          MET
America/Cambridge_Bay             America/Whitehorse                Australia/Adelaide        MST
America/Campo_Grande              America/Winnipeg                  Australia/Brisbane        MST7MDT
America/Cancun                    America/Yakutat                   Australia/Broken_Hill     PST8PDT
America/Caracas                   America/Yellowknife               Australia/Darwin          Pacific/Apia
America/Cayenne                   Antarctica/Casey                  Australia/Eucla           Pacific/Auckland
America/Chicago                   Antarctica/Davis                  Australia/Hobart          Pacific/Bougainville
America/Chihuahua                 Antarctica/DumontDUrville         Australia/Lindeman        Pacific/Chatham
America/Costa_Rica                Antarctica/Macquarie              Australia/Lord_Howe       Pacific/Chuuk
America/Creston                   Antarctica/Mawson                 Australia/Melbourne       Pacific/Easter
America/Cuiaba                    Antarctica/Palmer                 Australia/Perth           Pacific/Efate
America/Curacao                   Antarctica/Rothera                Australia/Sydney          Pacific/Enderbury
America/Danmarkshavn              Antarctica/Syowa                  CET                       Pacific/Fakaofo
America/Dawson                    Antarctica/Troll                  CST6CDT                   Pacific/Fiji
America/Dawson_Creek              Antarctica/Vostok                 EET                       Pacific/Funafuti
America/Denver                    Asia/Almaty                       EST                       Pacific/Galapagos
America/Detroit                   Asia/Amman                        EST5EDT                   Pacific/Gambier
America/Edmonton                  Asia/Anadyr                       Etc/GMT                   Pacific/Guadalcanal
America/Eirunepe                  Asia/Aqtau                        Etc/GMT+1                 Pacific/Guam
America/El_Salvador               Asia/Aqtobe                       Etc/GMT+10                Pacific/Honolulu
America/Fort_Nelson               Asia/Ashgabat                     Etc/GMT+11                Pacific/Kiritimati
America/Fortaleza                 Asia/Atyrau                       Etc/GMT+12                Pacific/Kosrae
America/Glace_Bay                 Asia/Baghdad                      Etc/GMT+2                 Pacific/Kwajalein
America/Goose_Bay                 Asia/Baku                         Etc/GMT+3                 Pacific/Majuro
America/Grand_Turk                Asia/Bangkok                      Etc/GMT+4                 Pacific/Marquesas
America/Guatemala                 Asia/Barnaul                      Etc/GMT+5                 Pacific/Nauru
America/Guayaquil                 Asia/Beirut                       Etc/GMT+6                 Pacific/Niue
America/Guyana                    Asia/Bishkek                      Etc/GMT+7                 Pacific/Norfolk
America/Halifax                   Asia/Brunei                       Etc/GMT+8                 Pacific/Noumea
America/Havana                    Asia/Chita                        Etc/GMT+9                 Pacific/Pago_Pago
America/Hermosillo                Asia/Choibalsan                   Etc/GMT-1                 Pacific/Palau
America/Indiana/Indianapolis      Asia/Colombo                      Etc/GMT-10                Pacific/Pitcairn
America/Indiana/Knox              Asia/Damascus                     Etc/GMT-11                Pacific/Pohnpei
America/Indiana/Marengo           Asia/Dhaka                        Etc/GMT-12                Pacific/Port_Moresby
America/Indiana/Petersburg        Asia/Dili                         Etc/GMT-13                Pacific/Rarotonga
America/Indiana/Tell_City         Asia/Dubai                        Etc/GMT-14                Pacific/Tahiti
America/Indiana/Vevay             Asia/Dushanbe                     Etc/GMT-2                 Pacific/Tarawa
America/Indiana/Vincennes         Asia/Famagusta                    Etc/GMT-3                 Pacific/Tongatapu
America/Indiana/Winamac           Asia/Gaza                         Etc/GMT-4                 Pacific/Wake
America/Inuvik                    Asia/Hebron                       Etc/GMT-5                 Pacific/Wallis
America/Iqaluit                   Asia/Ho_Chi_Minh                  Etc/GMT-6                 WET
America/Jamaica                   Asia/Hong_Kong                    Etc/GMT-7
America/Juneau                    Asia/Hovd                         Etc/GMT-8
America/Kentucky/Louisville       Asia/Irkutsk                      Etc/GMT-9
America/Kentucky/Monticello       Asia/Jakarta                      Etc/UTC
America/La_Paz                    Asia/Jayapura                     Europe/Amsterdam
America/Lima                      Asia/Jerusalem                    Europe/Andorra
America/Los_Angeles               Asia/Kabul                        Europe/Astrakhan
America/Maceio                    Asia/Kamchatka                    Europe/Athens
America/Managua                   Asia/Karachi                      Europe/Belgrade
America/Manaus                    Asia/Kathmandu                    Europe/Berlin
America/Martinique                Asia/Khandyga                     Europe/Brussels
America/Matamoros                 Asia/Kolkata                      Europe/Bucharest
America/Mazatlan                  Asia/Krasnoyarsk                  Europe/Budapest
America/Menominee                 Asia/Kuala_Lumpur                 Europe/Chisinau

Usage:
    python3 os_time.py -h                     =>    Prints This Help Document
    python3 os_time.py                        =>    Sets Your OS Date & Time America/New_York Timezone
    python3 os_time.py America/Los_Angeles    =>    Sets Your OS Date & Time America/Los_Angeles Timezone
"""

import re, requests, sys, platform
from os import system
from subprocess import Popen
from time import sleep
requests.urllib3.disable_warnings()
system('')


def set_ostime():
    df='America/New_York'
    name=platform.system()
    if len(sys.argv)>1:
        df=sys.argv[1]
        if df=='-h':
            print('\033[1;32;40m'+__doc__+'\033[0m')
            sys.exit()
    while True:
        try:
            res=requests.get(f'https://worldtimeapi.org/api/timezone/{df}',verify=False)
            datetime=res.json()['datetime']
            time=re.search('\d+:\d+:\d+',datetime).group()
            date=re.search('\d+-\d+-\d+',datetime).group()
            dt=date.split('-')
            if name=='Windows':
                t=Popen(['time',time],shell=True)
                d=Popen(['date',f'{dt[1]}-{dt[2]}-{dt[0]}'],shell=True)
            elif name=='Linux':
                Popen(f'sudo timedatectl set-time "{date} {time}"', shell=True)
            elif name=='Darwin':
                tt=time.split(':')
                Popen(f'sudo date {dt[1]}{dt[2]}{tt[0]}{tt[1]}{dt[0][-2:]}')
            break
        except requests.exceptions.ConnectionError:
            sleep(60)
        except Exception as e:
            if 'KeyboardInterrupt' not in str(e):
                print(f'\033[1;31;40m{df} Not A Valid Timezone!!\033[0m')
            break
set_ostime()
